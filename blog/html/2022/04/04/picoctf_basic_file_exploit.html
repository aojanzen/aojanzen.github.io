<!DOCTYPE html><!--[if lt IE 7]>      <html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:og="http://ogp.me/ns#"
    xmlns:fb="https://www.facebook.com/2008/fbml" class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:og="http://ogp.me/ns#"
    xmlns:fb="https://www.facebook.com/2008/fbml" class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:og="http://ogp.me/ns#"
    xmlns:fb="https://www.facebook.com/2008/fbml" class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:og="http://ogp.me/ns#"
    xmlns:fb="https://www.facebook.com/2008/fbml" class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="description" content="Hacking how-to for beginners, learnings from CTFs, note for myself">
        <meta name="viewport" content="width=device-width">
        <title>picoCTF: basic-file-exploit &mdash; From Noob to Hacker</title>
            <link rel="stylesheet" href="../../../_static/normalize.css" type="text/css">
            <link rel="stylesheet" href="../../../_static/sphinx.css" type="text/css">
            <link rel="stylesheet" href="../../../_static/main.css" type="text/css">
            <link rel="stylesheet" href="../../../_static/flat.css" type="text/css">
            <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
            <link rel="stylesheet" href="../../../_static/font-awesome.min.css" type="text/css">
        <link rel="shortcut icon" href="../../../_static/tinkerer.ico" /><!-- Load modernizr and JQuery -->
        <script src="../../../_static/vendor/modernizr-2.6.2.min.js"></script>
        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
        <script>window.jQuery || document.write('<script src="../../../_static/vendor/jquery-1.8.2.min.js"><\/script>')</script>
        <script src="../../../_static/plugins.js"></script>
        <script src="../../../_static/main.js"></script>
        <link rel="search" title="Search" href="../../../search.html" /><link rel="next" title="Hello World!" href="../../03/28/hello_world.html" /><link rel="prev" title="picoCTF: SQLiLite" href="picoctf_sqli_lite.html" /><link rel="alternate" type="application/rss+xml" title="RSS" href="../../../rss.html" /><script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '1.7.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        SOURCELINK_SUFFIX: '.txt',
        HAS_SOURCE:  true
      };
    </script><script type="text/javascript" src="../../../_static/underscore.js"></script><script type="text/javascript" src="../../../_static/doctools.js"></script>

    <script type="text/javascript">
        $(document).ready(function () {
            // Scroll to content if on small screen
            if (screen.width < 480)
            {
                $(document).scrollTop(document.getElementsByTagName("article")[0].offsetTop - 44);
            }
        });
    </script></head>
    <body role="document">
        <!--[if lt IE 7]>
            <p class="chromeframe">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">activate Google Chrome Frame</a> to improve your experience.</p>
        <![endif]-->

      <div id="container"><header role="banner">
            <hgroup>
              <h1><a href="../../../index.html">From Noob to Hacker</a></h1><h2>Things I have learned along the way</h2></hgroup>
          </header>
      <nav role="navigation">
            <ul><li class="main-nav">
                  <a href="../../../index.html">Home</a>
                </li>
              <li class="main-nav">
                  <a href="../../../pages/about.html">About</a>
                </li>
              <li class="main-nav">
                  <a href="../../../pages/ctf_writeups.html">CTF Writeups</a>
                </li>
              <li class="main-nav">
                  <a href="../../../pages/linux_and_tools.html">Linux and Tools</a>
                </li>
              <li class="main-nav">
                  <a href="../../../pages/hacking.html">Hacking and Networks</a>
                </li>
              </ul>
          </nav><div class="main-container" role="main"><div class="main wrapper body clearfix"><article><div class="timestamp postmeta">
            <span>April 04, 2022</span>
        </div>
    <div class="section" id="picoctf-basic-file-exploit">
<h1>picoCTF: basic-file-exploit</h1>
<p>This is my first writeup about a CTF challenge. The following was the first
task in the 100’s (i.e. lowest) category of the 2022 picoCTF challenge:</p>
<div id="more"> </div><p><a class="reference external" href="https://play.picoctf.org/practice/challenge/252?page=1&amp;search=basic-file-exploit">https://play.picoctf.org/practice/challenge/252?page=1&amp;search=basic-file-exploit</a></p>
<p>The task was described as follows:</p>
<blockquote>
<div><p><strong>Description:</strong></p>
<p>The program provided allows you to write to a file and read what you wrote
from it. Try playing around with it and see if you can break it! Connect to
the program with netcat:</p>
<p><span class="docutils literal"><span class="pre">$</span> <span class="pre">nc</span> <span class="pre">saturn.picoctf.net</span> <span class="pre">53641</span></span></p>
<p>The program’s source code with the flag redacted can be downloaded
<a class="reference external" href="https://artifacts.picoctf.net/c/540/program-redacted.c">here</a>.</p>
<p><strong>Hint:</strong></p>
<p>Try passing in things the program doesn’t expect. Like a string instead of
a number.</p>
</div></blockquote>
<p><strong>Solution</strong>:</p>
<p>You can see rather quickly that the sought flag was included in the original
program code, specifically in line 15 of the source code:</p>
<div class="code C highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">static</span> <span class="n">const</span> <span class="n">char</span><span class="o">*</span> <span class="n">flag</span> <span class="o">=</span> <span class="s2">&quot;[REDACTED]&quot;</span><span class="p">;</span>
</pre></div>
</div>
<p>We can now simply search for the variable name <span class="docutils literal"><span class="pre">flag</span></span> in the rest of the
source code to locate the part where we can break the code as indicated in the
hint. There is just one more occurrence of <span class="docutils literal"><span class="pre">flag</span></span> in the program: in the
function <span class="docutils literal"><span class="pre">data_read()</span></span>, line 144:</p>
<div class="code C highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="p">((</span><span class="n">entry_number</span> <span class="o">=</span> <span class="n">strtol</span><span class="p">(</span><span class="n">entry</span><span class="p">,</span> <span class="n">NULL</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">puts</span><span class="p">(</span><span class="n">flag</span><span class="p">);</span>
    <span class="n">fseek</span><span class="p">(</span><span class="n">stdin</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">SEEK_END</span><span class="p">);</span>
    <span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Obviously, the flag is output with <span class="docutils literal"><span class="pre">puts</span></span> if the library function <span class="docutils literal"><span class="pre">strtol</span></span>
returns 0. The function converts the string <span class="docutils literal"><span class="pre">entry</span></span> into a long integer with
base 10. See the following link for details:</p>
<p><a class="reference external" href="https://www.tutorialspoint.com/c_standard_library/c_function_strtol.htm">https://www.tutorialspoint.com/c_standard_library/c_function_strtol.htm</a></p>
<p>The function <span class="docutils literal"><span class="pre">data_read()</span></span> reads words back from the already entered words,
therefore it seems plausible that we have to start the program (i.e. connect
with nc), enter some data, and then chose the data reading function and enter a
string () that converts into a 0 when run through <span class="docutils literal"><span class="pre">strtol()</span></span>. That can either
be a non-numeric value (i.e. text) or the value 0 itself.</p>
<p>Let’s see if that plan works:</p>
<img alt="../../../_images/basic_file_exploit_2.png" src="../../../_images/basic_file_exploit_2.png" />
<p>It does! We have found the flag:</p>
<p><span class="docutils literal"><span class="pre">picoCTF{M4K3_5UR3_70_CH3CK_YOUR_1NPU75_C5BC1889}</span></span></p>
<p>The same trick works, too, if you enter 0 instead of a text. Maybe you want to
try that yourself.</p>
</div>

    <div class="postmeta">
        <div class="author">
            <span>Von Andreas Janzen</span>
        </div>
        
        
        </div><ul class="related clearfix">
            <li class="left"> &laquo; <a href="picoctf_sqli_lite.html">picoCTF: SQLiLite</a></li>
            <li class="right"><a href="../../03/28/hello_world.html">Hello World!</a> &raquo; </li>
        </ul></article><aside class="sidebar"><section><div class="widget">
    <h1>Aktuell</h1>
    <ul><li>
            <a href="../../06/02/utilizingsocialmedia.html">Utilizing Social Media</a>
        </li><li>
            <a href="../../06/02/googlefu.html">Google Fu</a>
        </li><li>
            <a href="../../06/02/informationgatheringwithburpsuite.html">Information Gathering with Burp Suite</a>
        </li><li>
            <a href="../../06/01/huntingsubdomains.html">Hunting Subdomains (Parts 1 and 2)</a>
        </li><li>
            <a href="../../06/01/identifyingwebsitetechnologies.html">Identifying Website Technologies</a>
        </li><li>
            <a href="../../05/30/huntingbreachedpasswordswithdehashed.html">Hunting Breached Credentials with DeHashed</a>
        </li><li>
            <a href="../../05/29/gatheringbreachedcredentials.html">Gathering Breached Credentials with Breach-Parse</a>
        </li><li>
            <a href="../../05/28/takingnotes.html">Taking Notes</a>
        </li><li>
            <a href="../../05/28/passivereconnaissanceoverview.html">An Overview of Passive Recon(naissance)</a>
        </li><li>
            <a href="../../05/28/identifyingourtarget.html">Identifying Our Target</a>
        </li></ul>
</div>
</section><section><div class="widget" id="searchbox" role="search">
    <h1><a href="#searchbox">Search</a></h1>
    <form action="../../../search.html" method="get">
        <input type="text" name="q" />
        <button type="submit"><span class="fa fa-search"></span></button>
    </form>
</div></section></aside></div> <!-- #main --></div> <!-- #main-container -->

        <div class="footer-container" role="contentinfo"><footer class="wrapper">&copy; Copyright 2022, Andreas Janzen. Powered by <a href="http://www.tinkerer.me/">Tinkerer</a> and <a href="http://sphinx.pocoo.org/">Sphinx</a>.</footer></div> <!-- footer-container -->

      </div> <!--! end of #container --><!--[if lt IE 7 ]>
          <script src="//ajax.googleapis.com/ajax/libs/chrome-frame/1.0.3/CFInstall.min.js"></script>
          <script>window.attachEvent('onload',function(){CFInstall.check({mode:'overlay'})})</script>
        <![endif]-->
    </body>
</html>