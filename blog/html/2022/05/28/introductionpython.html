<!DOCTYPE html><!--[if lt IE 7]>      <html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:og="http://ogp.me/ns#"
    xmlns:fb="https://www.facebook.com/2008/fbml" class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:og="http://ogp.me/ns#"
    xmlns:fb="https://www.facebook.com/2008/fbml" class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:og="http://ogp.me/ns#"
    xmlns:fb="https://www.facebook.com/2008/fbml" class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:og="http://ogp.me/ns#"
    xmlns:fb="https://www.facebook.com/2008/fbml" class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="description" content="Hacking how-to for beginners, learnings from CTFs, note for myself">
        <meta name="viewport" content="width=device-width">
        <title>Introduction to Python &mdash; From Noob to Hacker</title>
            <link rel="stylesheet" href="../../../_static/normalize.css" type="text/css">
            <link rel="stylesheet" href="../../../_static/sphinx.css" type="text/css">
            <link rel="stylesheet" href="../../../_static/main.css" type="text/css">
            <link rel="stylesheet" href="../../../_static/flat.css" type="text/css">
            <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
            <link rel="stylesheet" href="../../../_static/font-awesome.min.css" type="text/css">
        <link rel="shortcut icon" href="../../../_static/tinkerer.ico" /><!-- Load modernizr and JQuery -->
        <script src="../../../_static/vendor/modernizr-2.6.2.min.js"></script>
        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
        <script>window.jQuery || document.write('<script src="../../../_static/vendor/jquery-1.8.2.min.js"><\/script>')</script>
        <script src="../../../_static/plugins.js"></script>
        <script src="../../../_static/main.js"></script>
        <link rel="search" title="Search" href="../../../search.html" /><link rel="next" title="The Five Stages of Ethical Hacking" href="fivestagesofethicalhacking.html" /><link rel="prev" title="Discovering Email Adresses" href="discoveringemailadresses.html" /><link rel="alternate" type="application/rss+xml" title="RSS" href="../../../rss.html" /><script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '1.7.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        SOURCELINK_SUFFIX: '.txt',
        HAS_SOURCE:  true
      };
    </script><script type="text/javascript" src="../../../_static/underscore.js"></script><script type="text/javascript" src="../../../_static/doctools.js"></script>

    <script type="text/javascript">
        $(document).ready(function () {
            // Scroll to content if on small screen
            if (screen.width < 480)
            {
                $(document).scrollTop(document.getElementsByTagName("article")[0].offsetTop - 44);
            }
        });
    </script></head>
    <body role="document">
        <!--[if lt IE 7]>
            <p class="chromeframe">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">activate Google Chrome Frame</a> to improve your experience.</p>
        <![endif]-->

      <div id="container"><header role="banner">
            <hgroup>
              <h1><a href="../../../index.html">From Noob to Hacker</a></h1><h2>Things I have learned along the way</h2></hgroup>
          </header>
      <nav role="navigation">
            <ul><li class="main-nav">
                  <a href="../../../index.html">Home</a>
                </li>
              <li class="main-nav">
                  <a href="../../../pages/about.html">About</a>
                </li>
              <li class="main-nav">
                  <a href="../../../pages/ctf_writeups.html">CTF Writeups</a>
                </li>
              <li class="main-nav">
                  <a href="../../../pages/linux_and_tools.html">Linux and Tools</a>
                </li>
              <li class="main-nav">
                  <a href="../../../pages/hacking.html">Hacking and Networks</a>
                </li>
              </ul>
          </nav><div class="main-container" role="main"><div class="main wrapper body clearfix"><article><div class="timestamp postmeta">
            <span>May 28, 2022</span>
        </div>
    <div class="section" id="introduction-to-python">
<h1>Introduction to Python</h1>
<p>This is part of the “Introduction to Python” module of TCM Sec’s “Practical
Ethical Hacking” course. I have left out most of the material, which covers a
basic introduction to Python. The rest is an application of Python for network
programming.</p>
<div id="more"> </div><div class="section" id="sockets">
<h2>Sockets:</h2>
<p>Sockets are used to connect two nodes. They are used to connect an IP address
to an open port.</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/python3</span>
<span class="kn">import</span> <span class="nn">socket</span>

<span class="n">HOST</span> <span class="o">=</span> <span class="s2">&quot;127.0.0.1&quot;</span>
<span class="n">PORT</span> <span class="o">=</span> <span class="mi">7777</span>

<span class="n">s</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span>
<span class="n">s</span><span class="o">.</span><span class="n">connect</span><span class="p">((</span><span class="n">HOST</span><span class="p">,</span> <span class="n">PORT</span><span class="p">))</span>
</pre></div>
</div>
<p>The meaning of the parameters <span class="docutils literal"><span class="pre">socket.AF_INET</span></span> and <span class="docutils literal"><span class="pre">socket.SOCK_STREAM</span></span> is
explained in this article on socket programming by <a class="reference external" href="https://realpython.com/python-sockets/">Real Python</a>:</p>
<img alt="../../../_images/socket_realpython.png" src="../../../_images/socket_realpython.png" />
<p>We can now use the Linux tool <span class="docutils literal"><span class="pre">nc</span></span> (netcat) to listen for incoming traffic on
the chosen port (7777) of our localhost with <span class="docutils literal"><span class="pre">nc</span> <span class="pre">-nvlp</span></span> and get the following
if we then start our script:</p>
<img alt="../../../_images/socket_netcat.png" src="../../../_images/socket_netcat.png" />
</div>
<div class="section" id="building-a-port-scanner">
<h2>Building a Port Scanner:</h2>
<p>The following Python code provides a functional, but not very nice port
scanner. It shall demonstrate what can be done with Python using the <span class="docutils literal"><span class="pre">socket</span></span>
module.</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/python3</span>

<span class="kn">import</span> <span class="nn">socket</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>

<span class="c1"># Define your target</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
    <span class="n">target</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">gethostbyname</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="c1"># Translate hostname to IPv4</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Invalid amount of arguments!&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Syntax: python3 scanner.py &lt;ip&gt;&quot;</span><span class="p">)</span>

<span class="c1"># Add a pretty banner</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">50</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Scanning target &quot;</span> <span class="o">+</span> <span class="n">target</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Time started: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">50</span><span class="p">)</span>

<span class="k">try</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">port</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">85</span><span class="p">):</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span>
        <span class="n">socket</span><span class="o">.</span><span class="n">setdefaulttimeout</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">connect_ex</span><span class="p">((</span><span class="n">target</span><span class="p">,</span> <span class="n">port</span><span class="p">))</span> <span class="c1"># Returns an error indicator</span>
        <span class="k">if</span> <span class="n">result</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Port </span><span class="si">{</span><span class="n">port</span><span class="si">}</span><span class="s2"> is open.&quot;</span><span class="p">)</span>
        <span class="n">s</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="k">except</span> <span class="ne">KeyboardInterrupt</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Exiting program&quot;</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
<span class="k">except</span> <span class="n">socket</span><span class="o">.</span><span class="n">gaierror</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hostname could no be resolved.&quot;</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span>
<span class="k">except</span> <span class="n">socket</span><span class="o">.</span><span class="n">error</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Could not connect to server.&quot;</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
</pre></div>
</div>
<p><span class="docutils literal"><span class="pre">sys</span></span> is imported to get access to the command line arguments, specifically
to read the target’s IPv4 address or hostname. <span class="docutils literal"><span class="pre">datetime.datetime</span></span> is
imported to print a nice banner when the script starts. Finally, <span class="docutils literal"><span class="pre">socket</span></span>
is used to establish network connection to different ports on the target to
test whether they are open or not.</p>
<p><span class="docutils literal"><span class="pre">socket.gethostbyname</span></span> is an extra step that translates a hostname, e.g.
<span class="docutils literal"><span class="pre">www.google.com</span></span> into an IPv4 address. If the number of command line
arguments is not 2 (i.e. the script name plus the target IPv4 address or
hostname), an error message will be displayed.</p>
<p>In the <span class="docutils literal"><span class="pre">try/except</span></span> block, the script tries to run the code in the <span class="docutils literal"><span class="pre">try</span></span>
block. If an error occurs, the respective error is caught in one of the
<span class="docutils literal"><span class="pre">except</span></span> blocks below to make sure that the problem is treated correctly. The
range of ports is limited to the range from 50 to 85 and the timeout duration
is set to 1 second to keep the script reasonably fast. The range of possible
ports is otherwise from 1 to 65535, which is not practical if the ports are
scanned one after the other.</p>
<p><span class="docutils literal"><span class="pre">s.connect_ex</span></span> returns an error indicator: if a port is open, the result will
be 0. If a port is not open, it will return 1.</p>
<p>The error handling in the <span class="docutils literal"><span class="pre">except</span></span> clauses is still very basic. If the scan
is interrupted, e.g. by Ctrl + C, an error message is displayed and
<span class="docutils literal"><span class="pre">sys.exit()</span></span> is used to leave the script in a clean manner. If the hostname
cannot be resolved with DNS, a <span class="docutils literal"><span class="pre">gaierror</span></span> will be thrown, and we will again
exit the program cleanly after displaying an error message. Finally, if the
connection to the socket cannot be established, this socket error will be
handled in an analogous way.</p>
<p>The script is not very efficient because it scans one port after the other
rather than scanning several ports in parallel using threading. Running the
script with my router’s IPv4 address as the target shows that ports 53 and 80
are open in the specified port range:</p>
<img alt="../../../_images/port_scan.png" src="../../../_images/port_scan.png" />
<p>For fault finding, one could add a <span class="docutils literal"><span class="pre">print</span></span> command into the <span class="docutils literal"><span class="pre">for</span></span> loop to see
how the scan makes progress and if the open ports are actually found.</p>
</div>
</div>

    <div class="postmeta">
        <div class="author">
            <span>Von Andreas Janzen</span>
        </div>
        
        
        </div><ul class="related clearfix">
            <li class="left"> &laquo; <a href="discoveringemailadresses.html">Discovering Email Adresses</a></li>
            <li class="right"><a href="fivestagesofethicalhacking.html">The Five Stages of Ethical Hacking</a> &raquo; </li>
        </ul></article><aside class="sidebar"><section><div class="widget">
    <h1>Aktuell</h1>
    <ul><li>
            <a href="../../06/12/bruteforceattacks.html">Brute Force Attacks</a>
        </li><li>
            <a href="../../06/11/manualexploitation.html">Manual Exploitation</a>
        </li><li>
            <a href="../../06/10/gainingrootwithmetasploit.html">Gaining Root with Metasploit</a>
        </li><li>
            <a href="../../06/09/stagedvsnon_stagedpayloads.html">Staged vs Non-Staged Payloads</a>
        </li><li>
            <a href="../../06/09/enumeratingssh.html">Enumerating SSH</a>
        </li><li>
            <a href="../../06/09/scanningwithnessus.html">Scanning with Nessus</a>
        </li><li>
            <a href="../../06/08/reverservsbindshell.html">Reverse Shell vs Bind Shell</a>
        </li><li>
            <a href="../../06/06/researchingpotentialvulnerabilities.html">Researching Potential Vulnerabilities</a>
        </li><li>
            <a href="../../06/05/enumeratingsmb.html">Enumerating SMB</a>
        </li><li>
            <a href="../../06/04/enumeratinghttpandhttps.html">Enumerating HTTP and HTTPS</a>
        </li></ul>
</div>
</section><section><div class="widget" id="searchbox" role="search">
    <h1><a href="#searchbox">Search</a></h1>
    <form action="../../../search.html" method="get">
        <input type="text" name="q" />
        <button type="submit"><span class="fa fa-search"></span></button>
    </form>
</div></section></aside></div> <!-- #main --></div> <!-- #main-container -->

        <div class="footer-container" role="contentinfo"><footer class="wrapper">&copy; Copyright 2022, Andreas Janzen. Powered by <a href="http://www.tinkerer.me/">Tinkerer</a> and <a href="http://sphinx.pocoo.org/">Sphinx</a>.</footer></div> <!-- footer-container -->

      </div> <!--! end of #container --><!--[if lt IE 7 ]>
          <script src="//ajax.googleapis.com/ajax/libs/chrome-frame/1.0.3/CFInstall.min.js"></script>
          <script>window.attachEvent('onload',function(){CFInstall.check({mode:'overlay'})})</script>
        <![endif]-->
    </body>
</html>